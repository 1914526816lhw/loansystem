(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-161a9edc"],{"37b0":function(e,o,t){"use strict";t.r(o);var s=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",[t("el-alert",{attrs:{type:"warning","show-icon":""}},[t("div",{attrs:{slot:"title"},slot:"title"},[t("span",{staticStyle:{"font-weight":"bold"}},[e._v(e._s(e.userName)+"您好！")]),e._v("目前学生在线系统支持身份证号和手机号登录，为了更好的保护您的账号，请设复杂密码，切勿将收到的短信验证码泄露或转发他人。 ")])]),t("div",{staticClass:"btnGround"},[t("el-button",{attrs:{type:"primary"},on:{click:function(o){e.dialogPassword=!0}}},[e._v("修改登录密码")]),t("el-button",{attrs:{type:"primary"},on:{click:function(o){e.dialogPasswordQuesting=!0}}},[e._v("修改密码保护问题")]),t("el-button",{attrs:{type:"primary"},on:{click:function(o){e.dialogPhoto=!0}}},[e._v("修改登录手机号")])],1),t("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"修改登录密码",visible:e.dialogPassword,width:"30%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(o){e.dialogPassword=o}}},[t("el-form",{ref:"passwordForm",attrs:{"label-position":"top",size:"small",model:e.passwordForm,rules:e.rulesPassword}},[t("el-form-item",{attrs:{label:"原密码",prop:"oldPwd"}},[t("el-input",{attrs:{"show-password":"",autocomplete:"off"},model:{value:e.passwordForm.oldPwd,callback:function(o){e.$set(e.passwordForm,"oldPwd",o)},expression:"passwordForm.oldPwd"}})],1),t("el-form-item",{attrs:{label:"请输入新密码",prop:"newPwd"}},[t("el-input",{attrs:{size:"small","show-password":"",autocomplete:"off"},model:{value:e.passwordForm.newPwd,callback:function(o){e.$set(e.passwordForm,"newPwd",o)},expression:"passwordForm.newPwd"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"confirmNewPwd"}},[t("el-input",{attrs:{size:"small","show-password":"",autocomplete:"off"},model:{value:e.passwordForm.confirmNewPwd,callback:function(o){e.$set(e.passwordForm,"confirmNewPwd",o)},expression:"passwordForm.confirmNewPwd"}})],1),t("el-form-item",{attrs:{label:"验证码",prop:"code"}},[t("el-input",{attrs:{size:"large",placeholder:"不区分大小写",clearable:""},model:{value:e.passwordForm.code,callback:function(o){e.$set(e.passwordForm,"code",o)},expression:"passwordForm.code"}},[t("template",{slot:"append"},[t("div",{staticClass:"ValidCode disabled-select",on:{click:e.refreshCode}},e._l(e.codeList,(function(o,s){return t("span",{key:s,style:e.getStyle(o)},[e._v(e._s(o.code))])})),0)])],2)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(o){e.dialogPassword=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateLoginPassword}},[e._v("确 定")])],1)],1),t("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"修改密码保护问题",visible:e.dialogPasswordQuesting,width:"30%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(o){e.dialogPasswordQuesting=o}}},[t("el-form",{ref:"passwordQuestiongForm",attrs:{"label-position":"top",size:"small",model:e.passwordQuestiongForm,rules:e.rulesPasswordQuesting}},[t("el-form-item",{attrs:{label:"请选择您的新密保问题",prop:"userSecurityQuestion"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.passwordQuestiongForm.userSecurityQuestion,callback:function(o){e.$set(e.passwordQuestiongForm,"userSecurityQuestion",o)},expression:"passwordQuestiongForm.userSecurityQuestion"}},[t("el-option",{attrs:{label:"我就读的小学",value:"我就读的小学"}}),t("el-option",{attrs:{label:"我就读的高中",value:"我就读的高中"}}),t("el-option",{attrs:{label:"我最喜欢的歌曲",value:"我最喜欢的歌曲"}}),t("el-option",{attrs:{label:"我最爱的人",value:"我最爱的人"}})],1)],1),t("el-form-item",{attrs:{label:"请输入您的问题答案",prop:"userSecurityAnswer"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.passwordQuestiongForm.userSecurityAnswer,callback:function(o){e.$set(e.passwordQuestiongForm,"userSecurityAnswer",o)},expression:"passwordQuestiongForm.userSecurityAnswer"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(o){e.dialogPasswordQuesting=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateSecurityQuestion}},[e._v("确 定")])],1)],1),t("el-dialog",{staticStyle:{"text-align":"left"},attrs:{title:"修改登录手机号",visible:e.dialogPhoto,width:"30%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(o){e.dialogPhoto=o},closed:function(o){e.active=1}}},[t("el-steps",{attrs:{active:e.active,"process-status":"wait"}},[t("el-step",{attrs:{title:"验证密码"}}),t("el-step",{attrs:{title:"修改手机号"}})],1),1==e.active?t("el-form",{ref:"photoForm",attrs:{"label-position":"top",size:"small",model:e.photoForm,rules:e.rulesPhoto}},[t("el-form-item",{attrs:{label:"请输入您的密码",prop:"verifyPassword"}},[t("el-input",{attrs:{"show-password":"",autocomplete:"off"},model:{value:e.photoForm.verifyPassword,callback:function(o){e.$set(e.photoForm,"verifyPassword",o)},expression:"photoForm.verifyPassword"}})],1),t("el-form-item",{attrs:{label:"验证码",prop:"code"}},[t("el-input",{attrs:{size:"large",placeholder:"不区分大小写",clearable:""},model:{value:e.photoForm.code,callback:function(o){e.$set(e.photoForm,"code",o)},expression:"photoForm.code"}},[t("template",{slot:"append"},[t("div",{staticClass:"ValidCode disabled-select",on:{click:e.refreshCode}},e._l(e.codeList,(function(o,s){return t("span",{key:s,style:e.getStyle(o)},[e._v(e._s(o.code))])})),0)])],2)],1),t("el-form-item",{staticStyle:{"padding-bottom":"20px","text-align":"right"}},[t("el-button",{on:{click:function(o){e.dialogPhoto=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.verifyPassword}},[e._v("下 一 步")])],1)],1):t("el-form",{ref:"photoForm2",attrs:{"label-position":"top",size:"small",model:e.photoForm2,rules:e.rulesPhoto2}},[t("el-form-item",{attrs:{label:"手机号",prop:"newPhone"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.photoForm2.newPhone,callback:function(o){e.$set(e.photoForm2,"newPhone",o)},expression:"photoForm2.newPhone"}})],1),t("el-form-item",{attrs:{label:"验证码",prop:"code"}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-input",{attrs:{size:"large",placeholder:"不区分大小写",clearable:""},model:{value:e.photoForm2.code,callback:function(o){e.$set(e.photoForm2,"code",o)},expression:"photoForm2.code"}},[t("template",{slot:"append"},[t("div",{staticClass:"ValidCode disabled-select",on:{click:e.refreshCode}},e._l(e.codeList,(function(o,s){return t("span",{key:s,style:e.getStyle(o)},[e._v(e._s(o.code))])})),0)])],2),t("el-button",{staticStyle:{height:"40px","margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:function(o){return e.getCode(e.photoForm2.newPhone)}}},[e._v("发送验证码")])],1)]),t("el-form-item",{attrs:{label:"短信验证码",prop:"verifyCode"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.photoForm2.verifyCode,callback:function(o){e.$set(e.photoForm2,"verifyCode",o)},expression:"photoForm2.verifyCode"}})],1),t("el-form-item",{staticStyle:{"padding-bottom":"20px","text-align":"right"}},[t("el-button",{on:{click:function(o){e.dialogPhoto=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateUserPhone}},[e._v("完 成")])],1)],1)],1)],1)},r=[],a=(t("99af"),t("a15b"),t("d81d"),t("a9e3"),t("d3b7"),t("5530")),i={data:function(){var e=this;return{userName:"",codeList:[],confirmcode:"",active:1,dialogPassword:!1,passwordForm:{oldPwd:"",newPwd:"",confirmNewPwd:"",code:""},rulesPassword:{oldPwd:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:20,message:"密码为6到20位数字与字母组合",trigger:"blur"}],newPwd:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:20,message:"密码为6到20位数字与字母组合",trigger:"blur"}],confirmNewPwd:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:20,message:"密码为6到20位数字与字母组合",trigger:"blur"},{validator:function(o,t,s){return e.passwordForm.newPwd!==t?s(new Error("密码不相同")):s()},trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"},{validator:function(o,t,s){return e.confirmcode.toUpperCase()!==t.toUpperCase()?s(new Error("验证码不相同")):s()},trigger:"blur"}]},dialogPasswordQuesting:!1,passwordQuestiongForm:{userSecurityQuestion:"",userSecurityAnswer:""},rulesPasswordQuesting:{userSecurityQuestion:[{required:!0,message:"请选择密保问题",trigger:"blur"}],userSecurityAnswer:[{required:!0,message:"请回答密码问题",trigger:"blur"}]},dialogPhoto:!1,photoForm:{verifyPassword:"",code:""},rulesPhoto:{verifyPassword:[{required:!0,message:"密码不能为空",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"},{validator:function(o,t,s){return e.confirmcode.toUpperCase()!==t.toUpperCase()?s(new Error("验证码不正确")):s()},trigger:"blur"}]},photoForm2:{newPhone:"",verifyCode:"",code:""},rulesPhoto2:{newPhone:[{required:!0,message:"手机号不能为空",trigger:"blur"}],verifyCode:[{required:!0,message:"密码不能为空",trigger:"blur"}],code:[{required:!0,message:"验证码不能为空",trigger:"blur"},{validator:function(o,t,s){return e.confirmcode.toUpperCase()!==t.toUpperCase()?s(new Error("验证码不正确")):s()},trigger:"blur"}]}}},mounted:function(){this.createdCode(),this.userName=sessionStorage.getItem("userName")},methods:{refreshCode:function(){this.createdCode()},createdCode:function(){for(var e=4,o=[],t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",s=t.length,r=0;r<e;r++){var a=[Math.round(220*Math.random()),Math.round(240*Math.random()),Math.round(200*Math.random())];o.push({code:t.charAt(Math.floor(Math.random()*s)),color:"rgb(".concat(a,")"),fontSize:16+Number(Math.floor(15*Math.random()))+"px",padding:"".concat([Math.floor(10*Math.random())],"px"),transform:"rotate(".concat(Math.floor(90*Math.random())-Math.floor(90*Math.random()),"deg)")})}this.codeList=o,this.confirmcode=o.map((function(e){return e.code})).join("")},getStyle:function(e){return"color: ".concat(e.color,"; font-size: ").concat(e.fontSize,"; padding: ").concat(e.padding,"; transform: ").concat(e.transform)},updateLoginPassword:function(){var e=this,o=sessionStorage.getItem("userLoginAccount"),t=this.passwordForm,s=t.newPwd,r=t.oldPwd;this.$refs.passwordForm.validate((function(t){if(!t)return!1;e.$axios.post("/userLogin/updateLoginPassword",{userLoginAccount:o,oldPwd:r,newPwd:s}).then((function(o){var t=o.status;200==t?(e.$message({message:"修改成功",type:"success"}),e.dialogPassword=!1):401==t?e.$message({message:"修改失败，旧密码错误",type:"error"}):500==t&&(e.$message({message:"系统异常",type:"warning"}),e.dialogPassword=!1)})).catch((function(e){console.log(e)})).finally((function(){e.refreshCode()}))}))},updateSecurityQuestion:function(){var e=this,o=sessionStorage.getItem("userLoginAccount");this.$refs.passwordQuestiongForm.validate((function(t){if(!t)return!1;e.$axios.post("/user/updateSecurityQuestion",Object(a["a"])({userLoginAccount:o},e.passwordQuestiongForm)).then((function(o){var t=o.status;200==t?(e.$message({message:"修改成功",type:"success"}),e.dialogPasswordQuesting=!1):401==t?e.$message({message:"修改失败",type:"error"}):500==t&&(e.$message({message:"系统异常",type:"warning"}),e.dialogPasswordQuesting=!1)})).catch((function(e){console.log(e)})).finally((function(){e.refreshCode()}))}))},verifyPassword:function(){var e=this,o=sessionStorage.getItem("userLoginAccount");this.$refs.photoForm.validate((function(t){if(!t)return!1;e.$axios.post("/userLogin/verifyPassword",{userLoginAccount:o,verifyPassword:e.photoForm.verifyPassword}).then((function(o){var t=o.status;200==t?(e.$message({message:"验证成功",type:"success"}),e.active++):401==t?e.$message({message:"验证失败，密码错误",type:"error"}):500==t&&e.$message({message:"系统异常",type:"warning"})})).catch((function(e){console.log(e)})).finally((function(){e.refreshCode()}))}))},getCode:function(e){var o=this;e?this.$axios.post("/getCode",{userPhone:e},{ignore:!0}).then((function(e){var t=e.status;200==t?o.$message({message:"短信已发送",type:"success"}):o.$message({message:"短信发送失败",type:"error"})})).catch((function(e){console.log(e)})).finally((function(){o.refreshCode()})):this.$message({message:"手机号不能为空",type:"warning"})},updateUserPhone:function(){var e=this,o=sessionStorage.getItem("userLoginAccount"),t=this.photoForm2,s=t.newPhone,r=t.verifyCode;this.$refs.photoForm2.validate((function(t){if(!t)return!1;e.$axios.post("/user/updateUserPhone",{userLoginAccount:o,newPhone:s,verifyCode:r}).then((function(o){var t=o.status;200==t?(e.$message({message:"修改成功",type:"success"}),e.dialogPhoto=!1,e.active=1):401==t?e.$message({message:"修改失败,验证码错误",type:"error"}):402==t&&e.$message({message:"修改失败，新旧手机号相同",type:"warning"})})).catch((function(e){console.log(e)})).finally((function(){e.refreshCode()}))}))}}},n=i,l=(t("ab82"),t("2877")),c=Object(l["a"])(n,s,r,!1,null,"e330046c",null);o["default"]=c.exports},5511:function(e,o,t){},ab82:function(e,o,t){"use strict";var s=t("5511"),r=t.n(s);r.a}}]);
//# sourceMappingURL=chunk-161a9edc.60e6eb98.js.map